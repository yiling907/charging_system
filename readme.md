# 充电桩管理系统需求文档
## 一、文档概述
### 1. 文档目的
明确充电桩管理系统的功能范围、角色权限、数据模型及业务流程，为开发、测试、部署提供依据，确保系统满足运营方（超级管理员、管理员）与用户（充电用户）的核心需求。

### 2. 系统定位
一款集**设备管理、充电服务、数据统计、用户管理**于一体的全流程充电桩运营管理系统，支持多角色协作，实现充电桩从部署、运维到用户使用的全生命周期管理。

### 3. 核心目标
- 运营方：高效管理充电桩设备，实时监控运行状态，统计运营数据，降低运维成本。
- 用户：便捷查找可用充电桩，预约充电服务，查询充电记录与支付账单。


## 二、角色与权限设计
### 1. 角色定义
系统分为3类核心角色，各角色职责与权限边界清晰，避免越权操作。

| 角色 | 核心职责 | 适用人群 |
|------|----------|----------|
| 超级管理员（Superadmin） | 系统全局配置、角色权限分配、所有资源管理 | 系统最高负责人、技术负责人 |
| 管理员（Admin） | 充电桩设备运维、充电站管理、运营数据查看 | 运营人员、运维人员 |
| 用户（User） | 查找充电桩、预约充电、充电支付、查看个人记录 | 新能源汽车车主 |


### 2. 详细权限清单
| 权限模块 | 超级管理员（Superadmin） | 管理员（Admin） | 用户（User） |
|----------|--------------------------|-----------------|--------------|
| **用户管理** | 1. 创建/删除所有角色账号<br>2. 编辑用户信息（含角色变更）<br>3. 查看所有用户列表 | 1. 查看用户列表（不含超级管理员）<br>2. 禁用违规用户账号 | 1. 编辑个人信息（手机号、密码等）<br>2. 查看个人资料 |
| **充电站管理** | 1. 新增/删除充电站<br>2. 编辑充电站信息（地址、经纬度、联系方式等）<br>3. 启用/停用充电站 | 1. 编辑充电站信息<br>2. 启用/停用充电站<br>3. 查看充电站列表与详情 | 1. 查看充电站列表（含地址、可用充电桩数）<br>2. 查看充电站位置（地图展示） |
| **充电桩管理** | 1. 新增/删除充电桩<br>2. 编辑充电桩参数（功率、类型、固件版本等）<br>3. 标记设备状态（空闲/充电中/故障/维护中） | 1. 编辑充电桩参数<br>2. 标记设备状态<br>3. 查看充电桩运行日志<br>4. 发起维护工单 | 1. 查看充电桩状态（空闲/占用）<br>2. 查看充电桩类型（直流快充/交流慢充）与功率 |
| **充电记录管理** | 1. 查看所有用户的充电记录<br>2. 导出全量充电数据（Excel/CSV）<br>3. 处理异常充电订单 | 1. 查看所有充电记录<br>2. 导出运营范围内充电数据<br>3. 处理订单纠纷 | 1. 查看个人充电记录（时间、时长、费用、电量）<br>2. 导出个人记录 |
| **预约管理** | 1. 查看所有预约记录<br>2. 取消违规预约（如用户超时未使用） | 1. 查看预约记录<br>2. 取消违规预约<br>3. 处理预约冲突 | 1. 发起预约（选择充电桩、预约时间段）<br>2. 取消个人预约<br>3. 查看预约状态 |
| **维护管理** | 1. 查看所有维护记录<br>2. 分配维护工单给运维人员 | 1. 创建维护工单（故障报修、定期维护）<br>2. 编辑维护记录（维护内容、更换配件）<br>3. 标记维护完成 | 无权限（仅可通过客服反馈设备故障） |
| **数据统计** | 1. 查看全量运营数据（收入、充电量、设备利用率）<br>2. 查看多维度报表（按时间/区域/设备） | 1. 查看负责区域的运营数据<br>2. 查看设备利用率报表 | 1. 查看个人充电统计（月度充电量、费用） |
| **系统配置** | 1. 设置充电费率（按电量/时长计费）<br>2. 配置支付方式（微信/支付宝）<br>3. 设置预约超时规则（如预约后15分钟未到自动取消） | 无权限（仅可查看配置，不可修改） | 无权限 |


## 三、分角色功能清单
### 1. 超级管理员（Superadmin）功能
#### 1.1 系统管理
- **用户角色管理**：创建不同角色账号，为Admin分配管理范围（如指定某区域充电站），重置用户密码。
- **基础配置**：
  - 充电费率配置：支持按“电量（元/度）”或“时长（元/分钟）”设置计费规则，可区分直流/交流桩费率。
  - 预约规则配置：设置预约最大时长（如2小时）、超时取消阈值（如15分钟）、每日最大预约次数。
  - 支付配置：接入微信支付、支付宝支付接口，开启/关闭某支付方式。

#### 1.2 全量资源管理
- 覆盖Admin的所有设备管理功能，且无管理范围限制（可管理所有充电站/充电桩）。
- 全量数据导出：支持导出所有充电站的运营数据、所有用户的充电记录，导出格式含Excel、CSV。

#### 1.3 系统监控
- 查看系统运行日志：记录用户登录、关键操作（如删除充电桩、修改费率）、异常报错，支持按时间/操作人筛选。
- 设备状态总览：在首页展示全平台充电桩在线率、故障率、使用率，支持点击钻取到具体设备。


### 2. 管理员（Admin）功能
#### 2.1 充电站管理
- **充电站CRUD**：
  - 新增充电站：填写名称、详细地址、经纬度（支持地图选址）、联系方式、运营时间，上传充电站实景图。
  - 编辑/删除：修改充电站信息，停用低效/废弃充电站（停用后用户不可见）。
  - 充电站列表：按“运营状态（启用/停用）”“区域”筛选，展示每个充电站的充电桩总数、可用充电桩数。

#### 2.2 充电桩管理
- **充电桩CRUD**：
  - 新增充电桩：关联所属充电站，填写设备编号（唯一）、类型（DC直流快充/AC交流慢充）、功率（如60kW）、固件版本，设置初始状态（空闲）。
  - 状态管理：实时更新充电桩状态（空闲→充电中→空闲，故障→维护中→空闲），故障状态需填写故障原因（如“充电枪故障”“网络断开”）。
  - 维护记录：创建维护工单（关联充电桩、选择维护类型：定期检查/故障维修/固件升级），填写维护人员、维护内容、更换配件，标记维护完成后自动更新充电桩状态为“空闲”。

#### 2.3 运营数据统计
- 数据看板：展示负责区域的核心指标，包括：
  - 收入统计：今日/本周/本月收入总额，按充电站/充电桩维度拆分。
  - 设备统计：充电桩在线率（在线设备数/总设备数）、故障率（故障设备数/总设备数）、使用率（充电时长/总运营时长）。
  - 订单统计：今日/本周/本月充电订单数、平均充电时长、平均充电量。
- 报表导出：支持将上述统计数据导出为Excel，用于运营分析。

#### 2.4 订单与预约管理
- 充电订单管理：查看所有充电订单，筛选“未支付”“已支付”“退款中”订单，处理用户退款申请（需核实充电记录后操作）。
- 预约管理：查看用户预约记录，取消“超时未使用”的预约（如用户预约14:00-15:00，14:15仍未启动充电），释放充电桩资源。


### 3. 用户（User）功能
#### 3.1 充电桩查找与预约
- **充电桩查找**：
  - 列表视图：按“距离（由近及远）”“可用状态（空闲优先）”排序，展示充电桩所属充电站、类型、功率、当前状态，并且根据地址查找最近的充电桩。<br>
  -~~- **预约充电**：选择目标充电桩，设置预约时间段（如1小时内），提交后系统锁定该充电桩（锁定时长=预约超时阈值，如15分钟），超时未启动充电自动取消预约。做不完~~

#### 3.2 充电与支付
- **启动充电**：到达充电站后，扫描充电桩二维码或输入设备编号，如果该充电桩可用，且完成支付启动充电桩。
- **充电监控**：充电过程中实时展示充电时长、已充电量、当前费用，支持手动结束充电。
- **在线支付**：充电结束后生成账单（费用=充电量×费率），支持微信/支付宝支付，支付完成后生成电子凭证。

#### 3.3 个人中心
- 充电记录：查看所有个人充电记录，按“时间（近1个月/近3个月）”筛选，每条记录包含充电站名称、充电桩编号、充电时间、时长、电量、费用、支付状态。
- 个人设置：修改手机号、登录密码，查看个人充电统计（月度充电量、总费用）。


## 四、数据模型设计
### 1. 核心数据模型及字段
#### 1.1 用户表（User）
| 字段名 | 字段类型 | 约束 | 说明 |
|--------|----------|------|------|
| id | UUID | 主键 | 用户唯一标识 |
| username | String(50) | 非空、唯一 | 登录用户名（手机号/邮箱） |
| password | String(128) | 非空 | 加密存储的登录密码 |
| role | String(20) | 非空 | 角色类型（superadmin/admin/user） |
| phone | String(20) | 唯一 | 用户手机号（用于登录、通知） |
| email | String(100) | 唯一 | 用户邮箱（可选，用于找回密码） |
| is_active | Boolean | 非空，默认true | 账号状态（true=启用，false=禁用） |
| created_at | DateTime | 非空 | 账号创建时间 |
| updated_at | DateTime | 非空 | 账号信息更新时间 |

#### 1.2 充电站表（Station）
| 字段名 | 字段类型 | 约束 | 说明 |
|--------|----------|------|------|
| id | UUID | 主键 | 充电站唯一标识 |
| name | String(100) | 非空 | 充电站名称（如“XX商圈充电站”） |
| address | Text | 非空 | 详细地址（如“XX市XX区XX路XX号”） |
| latitude | Decimal(9,6) | 非空 | 纬度（用于地图定位） |
| longitude | Decimal(9,6) | 非空 | 经度（用于地图定位） |
| contact_phone | String(20) | 非空 | 充电站联系电话（用于用户反馈） |
| business_hours | String(50) | 非空，默认“24小时” | 运营时间 |
| is_active | Boolean | 非空，默认true | 运营状态（true=启用，false=停用） |
| created_at | DateTime | 非空 | 充电站创建时间 |
| updated_at | DateTime | 非空 | 充电站信息更新时间 |

#### 1.3 充电桩表（Charger）
| 字段名 | 字段类型 | 约束 | 说明 |
|--------|----------|------|------|
| id | UUID | 主键 | 充电桩唯一标识 |
| station_id | UUID | 非空，外键（关联Station.id） | 所属充电站 |
| code | String(50) | 非空、唯一 | 设备编号（如“DC-001”） |
| charger_type | String(20) | 非空 | 设备类型（DC=直流快充，AC=交流慢充） |
| power | Integer | 非空 | 设备功率（单位：kW，如60） |
| status | String(20) | 非空 | 运行状态（idle=空闲，charging=充电中，fault=故障，maintenance=维护中） |
| firmware_version | String(50) | 非空 | 固件版本（用于维护升级） |
| last_maintenance_at | Date | 可选 | 最近一次维护时间 |
| created_at | DateTime | 非空 | 设备安装时间 |
| updated_at | DateTime | 非空 | 设备状态更新时间 |

#### 1.4 充电记录表（ChargingRecord）
| 字段名 | 字段类型 | 约束 | 说明 |
|--------|----------|------|------|
| id | UUID | 主键 | 充电记录唯一标识 |
| charger_id | UUID | 非空，外键（关联Charger.id） | 关联的充电桩 |
| user_id | UUID | 非空，外键（关联User.id） | 充电用户 |
| car_license | String(20) | 非空 | 用户车牌号（如“京A12345”） |
| start_time | DateTime | 非空 | 充电开始时间 |
| end_time | DateTime | 可选 | 充电结束时间（未结束则为null） |
| duration | Integer | 可选 | 充电时长（单位：分钟，自动计算=end_time - start_time） |
| electricity | Decimal(5,2) | 可选 | 充电量（单位：kWh） |
| fee | Decimal(6,2) | 可选 | 充电费用（单位：元，自动计算=electricity×费率） |
| pay_status | String(20) | 非空 | 支付状态（unpaid=未支付，paid=已支付，refunded=已退款） |
| transaction_id | String(100) | 可选，唯一 | 支付交易号（微信/支付宝返回） |
| created_at | DateTime | 非空 | 记录创建时间 |

#### 1.5 预约表（Reservation）
| 字段名 | 字段类型 | 约束 | 说明 |
|--------|----------|------|------|
| id | UUID | 主键 | 预约记录唯一标识 |
| charger_id | UUID | 非空，外键（关联Charger.id） | 预约的充电桩 |
| user_id | UUID | 非空，外键（关联User.id） | 预约用户 |
| start_time | DateTime | 非空 | 预约开始时间 |
| end_time | DateTime | 非空 | 预约结束时间 |
| status | String(20) | 非空 | 预约状态（pending=待使用，confirmed=已确认，cancelled=已取消，expired=已超时） |
| created_at | DateTime | 非空 | 预约创建时间 |
| updated_at | DateTime | 非空 | 预约状态更新时间 |

#### 1.6 维护记录表（MaintenanceRecord）
| 字段名 | 字段类型 | 约束 | 说明 |
|--------|----------|------|------|
| id | UUID | 主键 | 维护记录唯一标识 |
| charger_id | UUID | 非空，外键（关联Charger.id） | 维护的充电桩 |
| admin_id | UUID | 非空，外键（关联User.id，role=admin） | 维护负责人 |
| maintenance_type | String(20) | 非空 | 维护类型（routine=定期检查，repair=故障维修，upgrade=固件升级） |
| content | Text | 非空 | 维护内容（如“更换充电枪，测试正常”） |
| parts_used | String(200) | 可选 | 更换配件（如“充电枪×1”） |
| maintenance_time | DateTime | 非空 | 维护开始时间 |
| duration | Integer | 非空 | 维护时长（单位：分钟） |
| created_at | DateTime | 非空 | 记录创建时间 |


### 2. 模型关系图
```
User(1) —— 1:N —— ChargingRecord(N) —— N:1 —— Charger(N) —— N:1 —— Station(1)
User(1) —— 1:N —— Reservation(N) —— N:1 —— Charger(N)
User(1, role=admin) —— 1:N —— MaintenanceRecord(N) —— N:1 —— Charger(N)
```


## 五、核心业务流程
### 1. 用户充电流程
1. **查找充电桩**：用户登录系统，通过“列表/地图”视图筛选空闲充电桩，查看充电站地址、费率、设备类型。
3. **支付账单 并 启动充电**：用户到达现场，扫描充电桩二维码→系统验证状态 -> 用户进行付款 →验证通过后且付款成功后启动充电。
4. **充电监控**：系统实时展示充电时长、电量、费用，用户可手动结束充电。

# 充电桩管理系统需求文档（补充核心业务流程）
## 五、核心业务流程
### 1. 用户充电全流程（含预约）
#### 1.1 流程概述
用户从“查找充电桩”到“完成充电支付”的全流程，覆盖预约、充电、支付闭环，确保操作便捷性与设备资源高效利用。

#### 1.2 详细步骤
| 步骤 | 操作主体 | 核心动作 | 系统响应 | 异常处理 |
|------|----------|----------|----------|----------|
| 1 | 用户 | 登录系统，进入“充电桩查找”页面 | 加载所有“启用”状态的充电站及充电桩，默认按“距离由近及远”排序，标注充电桩状态（绿色=空闲、蓝色=充电中、红色=故障） | 未登录用户：跳转至登录页，登录后返回原查找页面 |
| 2 | 用户 | 筛选充电桩（可按“设备类型（直流/交流）”“空闲状态”“费率”筛选），点击目标充电桩查看详情 | 展示充电桩所属充电站地址、导航路线、功率、当前状态、历史使用率、用户评价 | 无匹配结果：提示“当前区域暂无符合条件的空闲充电桩，建议扩大筛选范围” |
| 3 | 用户 | 发起预约（可选）：选择预约开始时间（当前时间+15分钟~2小时内）、预约时长（1~2小时） | 1. 校验该时间段内充电桩是否已被预约；<br>2. 校验通过：锁定充电桩，生成预约记录（状态=待使用），发送短信/APP通知（含预约时间、充电站地址）；<br>3. 校验失败：提示“该时间段已被预约，请选择其他时间” | 预约后用户取消：需在“预约开始前30分钟”操作，取消后释放充电桩资源 |
| 4 | 用户 | 到达充电站，启动充电（两种方式）：<br>- 方式1：扫描充电桩二维码；<br>- 方式2：在系统内“我的预约”中点击“启动充电” | 1. 校验用户身份+充电桩状态：<br>   - 有预约：校验是否在预约时间段内，且充电桩为“空闲”；<br>   - 无预约：直接校验充电桩是否为“空闲”；<br>2. 校验通过：发送启动指令至充电桩，生成充电记录（状态=充电中，start_time=当前时间）；<br>3. 校验失败：提示“充电桩已被占用/预约已超时，请选择其他设备” | 启动失败（如设备突然故障）：系统自动推荐同充电站其他空闲充电桩，并补偿1张“5元充电优惠券” |
| 5 | 用户 | 充电过程中，查看“充电监控”页面 | 实时刷新充电数据：<br>- 基础数据：充电时长（分钟）、已充电量（kWh）、当前费用（元）；<br>- 设备数据：充电桩实时功率、电压、电流；<br>- 预估数据：预估充满剩余时间、预估总费用 | 充电中断（如电网波动）：<br>1. 系统立即推送通知（含中断原因）；<br>2. 3分钟内自动重试启动；<br>3. 重试失败：自动结束充电，按实际充电量生成账单 |
| 6 | 用户 | 手动结束充电（如已充满或需提前离开），点击“结束充电”按钮 | 1. 发送停止指令至充电桩，更新充电记录（end_time=当前时间，duration=自动计算，electricity=实际充电量，fee=自动计算=electricity×费率）；<br>2. 解锁充电桩，状态更新为“空闲”；<br>3. 生成待支付账单，推送至用户“我的账单”页面 | 未手动结束：充电桩检测到“电池充满”或“预约时长结束”，自动停止充电并生成账单 |
| 7 | 用户 | 进入“我的账单”，选择待支付订单，点击“支付”，选择支付方式（微信/支付宝） | 1. 跳转至对应支付平台；<br>2. 支付成功：接收支付平台回调，更新充电记录（pay_status=已支付，transaction_id=支付单号），发送“支付成功+充电完成”通知（含电子凭证）；<br>3. 生成充电记录快照，支持用户导出（含充电时间、电量、费用、支付凭证号） | 支付超时（超过30分钟）：<br>1. 发送“账单即将超时”提醒；<br>2. 超时未支付：限制该用户后续预约功能，直至完成支付 |

用户相关页面： 
1. [x] 登陆面
   2. 用户名
   3. 用户密码
2. [x] 注册页面 检验规则
   3. 用户名
   4. 邮箱
   5. 密码
   6. 手机号
3. [x] 用户信息管理页面
   4. 用户名
   4. 邮箱
   5. 密码
   6. 手机号
4. [x] 充电站查找页面
   5. 查找逻辑（ 前端实现
      6. 根据站点名称查找
      7. 根据地点按照距离最近排序
      8. 按照充电桩类型进行查
      9. 按充电状态进行查找
   10. 展示字段
       11. 充电站名称
       12. 充电站地址
       13. 充电站 中可用充电桩类型
       14. 可用充电桩个数
       15. 总共有的充电桩个数
5. [x] 充电桩详情页面
   6. 展示字段
      7. 充电站信息 
         8. 充电站名称
         12. 充电站地址
         13. 充电站 中可用充电桩类型
         14. 可用充电桩个数
         15. 总共有的充电桩个数
      16. 充电桩信息
          17. 所有信息进行展示+收费标准
6. [x] 点击充电后付款页面
7. [x] 历史订单记录
   8. 展示字段
      9. 全部字段

需要解决的bug
1. [ ] api key 通过asw管理和维护
2. [ ] 确定需要使用的aws的资源
3. [ ] 接入google pay
4. [ ] 接口的权限管理
5. [ ] 数据导入
### 2. 充电桩运维流程（管理员操作）
#### 2.1 流程概述
管理员从“设备状态监控”到“维护完成验收”的全流程，覆盖故障响应、维护工单、状态更新，确保设备正常运行。

#### 2.2 详细步骤
| 步骤 | 操作主体 | 核心动作 | 系统响应 | 数据同步 |
|------|----------|----------|----------|----------|
| 1 | 系统 | 实时监控充电桩状态，检测到“故障”（如设备离线、充电中断、电流异常） | 1. 立即推送故障通知至管理员（含充电桩编号、所属充电站、故障类型、发生时间）；<br>2. 更新充电桩状态为“故障”，用户端标记为红色，不可预约/使用 | 故障记录存入“设备日志”，包含故障代码、故障描述、触发条件 |
| 2 | 管理员 | 登录系统，进入“设备运维”页面，查看故障列表，点击“处理故障” | 1. 展示该充电桩的历史故障记录、维护记录、设备参数；<br>2. 提供“创建维护工单”按钮，支持选择维护人员（仅“admin”角色）、填写预计维护时间 | 工单状态初始为“待处理”，关联至对应充电桩，同步显示在“运维看板” |
| 3 | 管理员（维护人员） | 到达现场，在系统内点击“开始维护”，记录维护过程（如“检查充电枪接口，发现接触不良，更换接口配件”） | 1. 更新维护工单状态为“维护中”；<br>2. 更新充电桩状态为“维护中”，用户端标注“维护中，暂不可用”；<br>3. 支持上传维护现场照片（如故障部件、更换配件） | 实时记录维护时长，从“开始维护”到“完成维护”自动计算 |
| 4 | 管理员（维护人员） | 维护完成后，点击“测试设备”，执行系统内置测试流程（如“模拟充电10分钟，检测功率、电流是否正常”） | 1. 测试通过：提示“设备测试正常，可恢复使用”；<br>2. 测试失败：提示“测试未通过，请重新检查维护内容”，支持查看测试日志（如“电流波动超出正常范围”） | 测试结果存入维护工单，作为后续设备故障分析依据 |
| 5 | 管理员（维护人员） | 测试通过后，点击“完成维护”，填写维护总结（如“更换充电枪接口，测试正常，预计下次维护时间2025-12-31”） | 1. 更新维护工单状态为“已完成”，归档至“维护记录”；<br>2. 更新充电桩状态为“空闲”，用户端恢复可预约/使用；<br>3. 更新充电桩“last_maintenance_at”为当前日期 | 维护记录关联至充电桩，支持管理员后续查询“某设备的历史维护次数、常见故障类型” |
| 6 | 管理员（运营） | 定期查看“设备运维报表”，分析故障频率、维护成本 | 生成报表：<br>- 按设备维度：故障率（故障次数/总运行天数）、平均维护时长；<br>- 按区域维度：各充电站故障设备占比；<br>- 按时间维度：月度故障趋势、维护工单完成率 | 报表支持导出Excel，用于运营复盘（如“某品牌充电桩故障率高，考虑后续更换供应商”） |


### 3. 充电费率调整流程（超级管理员操作）
#### 3.1 流程概述
超级管理员根据运营成本、市场竞争调整充电费率，支持按“设备类型（直流/交流）”“时间段（峰/平/谷）”差异化定价，确保费率调整透明可追溯。

#### 3.2 详细步骤
| 步骤 | 操作主体 | 核心动作 | 系统响应 | 影响范围 |
|------|----------|----------|----------|----------|
| 1 | 超级管理员 | 登录系统，进入“系统配置-费率管理”页面，点击“新增费率规则” | 展示费率配置表单，支持设置：<br>- 适用设备类型（单选：直流快充/交流慢充/全部）；<br>- 适用时间段（单选：全天/峰时（8:00-22:00）/谷时（22:00-次日8:00））；<br>- 费率（元/kWh，精确到小数点后2位，如1.88元/kWh）；<br>- 生效时间（可选“立即生效”或“指定时间生效”） | 表单校验：<br>- 费率需大于0；<br>- 同一“设备类型+时间段”不可重复配置；<br>- 指定生效时间需晚于当前时间 |
| 2 | 超级管理员 | 填写费率规则，点击“预览” | 生成费率规则预览表，展示“适用范围、费率、生效时间、创建人”，并提示“当前已有规则：如直流快充峰时费率1.68元/kWh，新规则生效后将覆盖旧规则” | 预览页面支持“返回修改”或“确认提交” |
| 3 | 超级管理员 | 确认无误后，点击“提交” | 1. 保存新费率规则，状态标记为“待生效”（若指定生效时间）或“已生效”（若立即生效）；<br>2. 记录操作日志（含操作人、操作时间、旧规则、新规则）；<br>3. 若指定生效时间：系统创建定时任务，到期自动更新规则状态为“已生效” | 旧规则处理：新规则生效后，旧规则自动标记为“已失效”，保留历史记录可查询 |
| 4 | 系统 | 费率规则生效时 | 1. 推送通知至所有管理员（含“新费率生效时间、适用范围、具体费率”）；<br>2. 更新用户端“充电桩详情页”的费率展示，标注“当前费率：X元/kWh（峰时）”；<br>3. 后续新生成的充电账单，自动按新费率计算费用 | 已启动的充电订单：按“充电开始时的费率”计算，不受中途费率调整影响 |
| 5 | 管理员/用户 | 查看费率记录 | 管理员：可查看所有历史费率规则（含生效/失效状态、操作人）；<br>用户：可在“帮助中心-费率说明”查看当前生效的费率规则，及“费率调整历史”（仅展示近6个月） | 禁止用户修改费率，仅支持查看；管理员无费率调整权限，仅可查看 |


### 4. 用户违规处理流程（管理员操作）
#### 4.1 流程概述
针对用户“预约超时未使用”“恶意占用充电桩（充电完成后30分钟内未驶离）”“虚假报修”等违规行为，管理员执行警告、限制功能、封禁账号等处理，维护运营秩序。

#### 4.2 详细步骤
| 违规类型 | 操作主体 | 处理流程 | 系统响应 | 恢复机制 |
|----------|----------|----------|----------|----------|
| 预约超时未使用（1个月内≥3次） | 管理员 | 1. 系统自动标记“疑似违规”，推送提醒至管理员；<br>2. 管理员核实记录（查看该用户近1个月预约取消/超时记录）；<br>3. 确认违规后，执行“限制预约功能7天” | 1. 发送违规通知至用户（含违规原因、限制时长）；<br>2. 用户端“预约”功能置灰，提示“因多次预约超时，预约功能已限制至X年X月X日”；<br>3. 记录用户违规次数（累计计入用户信用分） | 限制期满后，系统自动恢复预约功能；用户可联系客服申诉（需提供合理理由，管理员审核通过后可提前恢复） |
| 恶意占用充电桩（充电完成后30分钟未驶离，被其他用户投诉） | 管理员 | 1. 接收用户投诉（含充电桩编号、占用车辆车牌号、投诉时间）；<br>2. 调取充电桩监控记录（或联系充电站现场人员核实）；<br>3. 确认占用属实后，执行“警告+扣除信用分10分” | 1. 发送警告通知至占用用户（含“占用时间、违规后果、信用分扣除情况”）；<br>2. 更新用户信用分（初始100分，低于60分将限制预约）；<br>3. 通知投诉用户“已处理，占用车辆已驶离” | 信用分每月自动恢复5分（最多恢复至100分）；用户可通过“完成充电后及时驶离”“参与系统活动”额外恢复信用分 |
| 虚假报修（报修后管理员核实设备无故障，1个月内≥2次） | 管理员 | 1. 系统自动关联“用户报修记录”与“管理员维护记录”，标记“虚假报修嫌疑”；<br>2. 管理员二次核实（查看维护工单中的测试日志、设备运行日志）；<br>3. 确认虚假报修后，执行“封禁账号7天” | 1. 发送封禁通知至用户（含封禁原因、封禁时长）；<br>2. 封禁期间用户无法登录系统，已预约的订单自动取消；<br>3. 记录封禁记录至用户账号档案 | 封禁期满后自动解封；若1年内累计封禁≥3次，执行“永久封禁”，用户需联系客服提交身份证明申请解封（管理员审核通过后方可恢复） |